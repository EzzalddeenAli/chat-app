<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

      body {
        font: 13px Helvetica, Arial;
      }

      form {
        background: #000;
        padding: 3px;
        position: fixed;
        bottom: 0;
        width: 100%;
      }

      form input {
        border: 0;
        padding: 10px;
        width: 90%;
        margin-right: .5%;
      }

      form button {
        width: 9%;
        background: rgb(130, 224, 255);
        border: none;
        padding: 10px;
      }

      #messages {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }

      #messages li {
        padding: 5px 10px;
        display: block;
        min-height: 45px;
      }

      .msg-area {
        float: left;
      }

      .date {
        float: right;
        margin-top: 10px;
      }

      .message {
        clear: both;
        display: block;
      }

      #messages li:nth-child(odd) {
        background: #eee;
      }
    </style>
  </head>

  <body>
    <ul id="messages"></ul>

    <form>
      <input id="user" type="text" placeholder="Nome">
      <br>
      <input id="msg" type="text" placeholder="Mensagem">
      <button>Send</button>
    </form>

    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

    <script>
      var socket = io();

      $('form').submit(function(){
        var obj;

        obj = {
          'user': $('#user').val(),
          'msg': $('#msg').val(),
          'timestamp': new Date().getTime()
        };

        socket.emit('chat message', obj);

        $('#user').val('');
        $('#msg').val('');

        return false;
      });

      socket.on('guest_connected', function(obj) {
        _buildLog(obj);
      });

      socket.on('guest_disconnect', function(obj) {
        _buildLog(obj);
      });

      socket.on('new_user', function(obj) {
        _buildLog(obj);
      });

      socket.on('chat_message', function(obj){
        _buildLog(obj);
      });

      function _buildLog(obj) {
        console.log(obj);

       var li, div, h4, p, date;

        li = $('<li>');
        div = $('<div class="msg-area">');

        h4 = $('<h4 class="user">').text(obj.user);
        p = $('<p class="message">').text(obj.msg);
        date = $('<span class="date">').text(obj.timestamp);

        (li).append(div);
        (li).append(date);

        (div).append(h4);
        (div).append(p);

        $('#messages').append(li);
      }
    </script>

  </body>
</html>